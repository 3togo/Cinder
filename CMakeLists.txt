cmake_minimum_required( VERSION 3.0 FATAL_ERROR )
set( CMAKE_VERBOSE_MAKEFILE ON )

project( cinder )

set( CINDER_TARGET "" CACHE STRING "Target platform to build for." )
option( CINDER_BUILD_SAMPLES "Build Samples" OFF )
option( CINDER_FREETYPE_USE_SYSTEM "Use system-detected freetype2 rather than the one that ships with cinder" OFF )

set( CINDER_ROOT      "${CMAKE_CURRENT_SOURCE_DIR}" )
set( CINDER_CMAKE_DIR "${CMAKE_CURRENT_SOURCE_DIR}/proj/cmake" )

# If there's a target specified, try to build for that. Otherwise, build 
# based the current host OS.
if( CINDER_TARGET )
	if( "android" STREQUAL "${CINDER_TARGET}" )
		include( "${CMAKE_CURRENT_SOURCE_DIR}/proj/cmake/platform_android.cmake" )
	elseif( "ios" STREQUAL "${CINDER_TARGET}" )
		include( "${CMAKE_CURRENT_SOURCE_DIR}/proj/cmake/platform_ios.cmake" )
	elseif( "linux" STREQUAL "${CINDER_TARGET}" )
		include( "${CMAKE_CURRENT_SOURCE_DIR}/proj/cmake/platform_linux.cmake" )
	elseif( "macosx" STREQUAL "${CINDER_TARGET}" )
		include( "${CMAKE_CURRENT_SOURCE_DIR}/proj/cmake/platform_macosx.cmake" )
	elseif( "msw" STREQUAL "${CINDER_TARGET}" )
		include( "${CMAKE_CURRENT_SOURCE_DIR}/proj/cmake/platform_msw.cmake" )
	else()
		message( FATAL_ERROR "unexpected CINDER_TARGET '${CINDER_TARGET}'." )
	endif()
else()
	if( CMAKE_SYSTEM_NAME MATCHES "Darwin" )
        set( CINDER_TARGET "android" ) # currently cross compiling to android on mac
		include( "${CMAKE_CURRENT_SOURCE_DIR}/proj/cmake/platform_android.cmake" )
	elseif( CMAKE_SYSTEM_NAME MATCHES "Linux" )
        set( CINDER_TARGET "linux" )
		include( "${CMAKE_CURRENT_SOURCE_DIR}/proj/cmake/platform_linux.cmake" )
	elseif( CMAKE_SYSTEM_NAME MATCHES "Windows" )
        set( CINDER_TARGET "msw" )
		include( "${CMAKE_CURRENT_SOURCE_DIR}/proj/cmake/platform_msw.cmake" )
	else()
		message( FATAL_ERROR "CINDER_TARGET not defined, and no default for platform '${CMAKE_SYSTEM_NAME}.'" )
	endif()
endif()

if( CINDER_BUILD_SAMPLES )
	set( CINDER_SAMPLES TRUE )
	add_subdirectory( ${CINDER_ROOT}/samples/BasicApp/proj/cmake ${CINDER_ROOT}/tmpbuild )
endif()